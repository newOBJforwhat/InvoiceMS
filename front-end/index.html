<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>发票管理系统</title>
  <link href="./css/bootstrap.min.css" rel="stylesheet">
  <link href="./css/bootstrap-table.min.css" rel="stylesheet">
  <link href="./css/bootstrap-datepicker3.min.css" rel="stylesheet">
  <link href="./css/myStyle/style.css" rel="stylesheet">
  <script type="text/javascript" src="./lib/jquery.min.js"></script>
</head>
<body>

<header class="global-header">
  <h1>发票管理系统</h1>
  <h4 class="welcome-info">欢迎您,&nbsp;
    <span class="username" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></span>
    <ul class="dropdown-menu" aria-labelledby="dLabel">
      <li><a href="javascript:void(0)" onclick="logout()">退出登录</a></li>
    </ul>
  </h4>
</header>

<aside class="menu-left-bar">
  <ul class="menu-list">
    <li id="input" class="menu-item"><a href="./index.html?type=input">录入</a></li>
    <li id="preview" class="menu-item"><a href="./index.html?type=preview">查阅</a></li>
    <li id="verify" class="menu-item"><a href="javascript:void(0)" onclick="goVerify()">审核</a></li>
    <li id="admin" class="menu-item"><a href="./index.html?type=admin">用户管理</a></li>
  </ul>
</aside>

<main class="main">
  <form id="form"></form>
  <section id="table-container"></section>
</main>

<div id="fail-modal" class="modal fade bs-example-modal-sm in" tabindex="-1">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content">

      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span>
        </button>
        <h4 class="modal-title">提交失败</h4>
      </div>
      <div class="modal-body fail-modal-body">
        提交失败, 请重试, 多次失败请联系管理员
      </div>
    </div>
  </div>
</div>

<div id="small-modal" class="modal fade bs-example-modal-sm in" tabindex="-1">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content">

      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span>
        </button>
        <h4 class="modal-title">确认信息</h4>
      </div>
      <div class="modal-body"></div>
      <div class="modal-footer">
        <button class="btn btn-primary confirm-button">确认</button>
        <button class="btn btn-danger cancel-button" data-dismiss="modal">取消</button>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="./lib/bootstrap.min.js"></script>
<script type="text/javascript" src="./lib/bootstrap-table.min.js"></script>
<script type="text/javascript" src="./lib/bootstrap-table-zh-CN.min.js"></script>
<script type="text/javascript" src="./lib/bootstrap-datepicker.min.js"></script>
<script type="text/javascript" src="./lib/bootstrap-datepicker.zh-CN.min.js"></script>
<script type="text/javascript" src="./js/utils.js"></script>
<script src="./js/input.js" type="text/javascript"></script>
<script src="./js/preview.js" type="text/javascript"></script>
<script src="./js/verify.js" type="text/javascript"></script>
<script src="./js/admin.js" type="text/javascript"></script>
<script type="text/javascript">
  var userInfo = {}
  var utils = Utils()

  $(function () {
    userInfo = {
      username: sessionStorage.getItem('username'),
      type: sessionStorage.getItem('type'),
      name: sessionStorage.getItem('name')
    }
    $('.username').html(userInfo.name)
    $.extend($.fn.bootstrapTable.defaults, $.fn.bootstrapTable.locales['zh-CN'])

    var params = location.href.split('=')[1]
    var type = params.split('&&')[0]
    var role = params.split('&&')[1]
    window[type](utils, role)
    $('.menu-item').each(function (index, elm) {
      $(elm).removeClass('active')
    })
    $('#' + type).addClass('active')
  })

  function logout() {
    location.href = 'login.html'
  }

  function goVerify() {
    console.log(userInfo)
    switch (userInfo.type) {
      case '2':
        location.href = './index.html?type=verify&&department'
        break
      case '3':
        location.href = './index.html?type=verify&&financial'
        break
      default:
        location.href = './index.html?type=verify'
        break
    }
  }
</script>
</body>
</html>